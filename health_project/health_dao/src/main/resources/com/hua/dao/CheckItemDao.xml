<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.hua.dao.CheckItemDao">

    <!--分页查询检查项-->
    <select id="findPage" resultType="CheckItem" parameterType="java.lang.String">
          select * from t_checkitem
          <if test="value != null and value.length > 0">
              where name = #{value} or code = #{value}
          </if>
    </select>

    <!--添加检查项-->
    <insert id="add" parameterType="CheckItem">

        INSERT INTO `t_checkitem` (`id`, `code`, `name`, `sex`, `age`, `price`, `type`, `attention`, `remark`)
        VALUES (null, #{code},#{name},#{sex}, #{age}, #{price},#{type}, #{attention},  #{remark});
    </insert>

    <!--根据id删除检查项-->
    <delete id="delById" parameterType="java.lang.Integer">
        delete from t_checkitem where id = #{id}
    </delete>

    <!--检查检查项是否关联检查组-->
    <select id="findByCheckItemId" parameterType="java.lang.Integer" resultType="java.lang.Integer">
        select count(1) from t_checkgroup_checkitem where checkitem_id = #{id}
    </select>

    <!--根据id查找检查项-->
    <select id="findById" parameterType="java.lang.Integer" resultType="CheckItem">
        select * from t_checkitem where id = #{id}
    </select>

    <!--编辑检查项-->
    <update id="update" parameterType="CheckItem">
        update t_checkitem
        <set>
            <if test="code != null"> code = #{code,jdbcType=VARCHAR},</if>
            <if test="name != null"> name = #{name},</if>
            <if test="sex != null"> sex = #{sex},</if>
            <if test="age != null"> age = #{age},</if>
            <if test="price != null"> price = #{price},</if>
            <if test="type != null"> type = #{type},</if>
            <if test="attention != null"> attention = #{attention},</if>
            <if test="remark != null"> remark = #{remark},</if>
        </set>
        <where>
            id = #{id}
        </where>
    </update>

    <!--获取所有检查项-->
    <select id="findAll" resultType="CheckItem">
        select * from t_checkitem
    </select>

    <!--获取套餐详情(套餐+检查组+检查项)-->
    <select id="findCheckItemListByCheckGroupId" parameterType="int" resultType="CheckItem">
        select * from t_checkitem where id in(select checkitem_id from t_checkgroup_checkitem where checkgroup_id = #{id})
    </select>
</mapper>